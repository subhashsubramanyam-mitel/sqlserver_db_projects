



CREATE VIEW [analytics].[vw_calendar] AS

select

dbo.TimeLookup.theDate,
convert(varchar,dbo.TimeLookup.theDate,23) as theDateOnly,
case
	when dbo.TimeLookup.theDay = 'Saturday' then 0
	when dbo.TimeLookup.theDay = 'Sunday' then 0
	when dbo.TimeLookup.theDate in ('2019-01-01','2019-02-18','2019-05-27','2019-07-04','2019-09-02','2019-11-28','2019-11-29','2019-12-24','2019-12-25','2019-12-31','2020-01-01','2020-02-17','2020-05-25','2019-07-04','2020-09-07','2020-11-26','2019-11-29','2019-12-24','2019-12-25','2019-12-31','2019-01-01','2021-02-15','2021-05-31','2019-07-04','2021-09-06','2021-11-25','2019-11-29','2019-12-24','2019-12-25','2019-12-31','2019-01-01','2022-02-21','2022-05-30','2019-07-04','2022-09-05','2022-11-24','2019-11-29','2019-12-24','2019-12-25','2019-12-31','2019-01-01','2023-02-20','2023-05-29','2019-07-04','2023-09-04','2023-11-23','2019-11-29','2019-12-24','2019-12-25','2019-12-31') then 0
	else 1
end as 'WorkdayFlag'


from dbo.TimeLookup;

